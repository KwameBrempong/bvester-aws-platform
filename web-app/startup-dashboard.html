<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://apis.google.com https://*.firebaseapp.com https://*.googleapis.com https://us-central1-bizinvest-hub-prod.cloudfunctions.net; style-src 'self' 'unsafe-inline'; font-src 'self' data:; img-src 'self' data: https:; connect-src 'self' https://bvester-backend.vercel.app https://bizinvest-hub-prod.firebaseapp.com https://identitytoolkit.googleapis.com https://firestore.googleapis.com https://us-central1-bizinvest-hub-prod.cloudfunctions.net https://*.googleapis.com https://*.firebaseio.com wss://*.firebaseio.com; frame-src 'none'; object-src 'none'; base-uri 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    
    <title>Startup Dashboard - Bvester</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000000;
            color: #ffffff;
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
            /* Hide content until authentication is verified */
            visibility: hidden;
        }

        /* Left Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #1a1a1a 0%, #0d0d0d 100%);
            border-right: 1px solid #ffd700;
            padding: 24px 0;
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .sidebar.mobile-hidden {
            transform: translateX(-100%);
        }

        .sidebar-header {
            padding: 0 24px 24px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
            margin-bottom: 24px;
        }

        .sidebar-logo {
            font-size: 28px;
            font-weight: 800;
            color: #ffd700;
            text-decoration: none;
            display: block;
            margin-bottom: 8px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 16px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000000;
            font-weight: 600;
            font-size: 16px;
        }

        .user-details {
            flex: 1;
        }

        .user-name {
            font-size: 14px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 2px;
        }

        .user-role {
            font-size: 12px;
            color: #ffd700;
            font-weight: 500;
        }

        /* Sidebar Navigation */
        .sidebar-nav {
            padding: 0;
        }

        .nav-section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 12px;
            font-weight: 600;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 24px 12px;
            margin-bottom: 8px;
        }

        .nav-item {
            margin-bottom: 4px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 24px;
            color: #cccccc;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-link:hover {
            background: rgba(255, 215, 0, 0.1);
            color: #ffd700;
            border-left-color: #ffd700;
        }

        .nav-link.active {
            background: rgba(255, 215, 0, 0.15);
            color: #ffd700;
            border-left-color: #ffd700;
        }

        .nav-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .nav-badge {
            background: #ffd700;
            color: #000000;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        .premium-icon {
            color: #ffd700;
            font-size: 12px;
            margin-left: 4px;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .nav-link:hover .premium-icon {
            opacity: 1;
        }

        /* Premium Feature Styling */
        .premium-feature {
            position: relative;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .premium-feature:hover {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
            border-color: #ffd700;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
        }

        .premium-feature::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(135deg, #ffd700, #ffed4a, #ffd700);
            border-radius: inherit;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .premium-feature:hover::before {
            opacity: 0.3;
        }

        .action-btn.premium-feature {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            color: #000000;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .action-btn.premium-feature:hover {
            background: linear-gradient(135deg, #ffed4a, #fff176);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
        }

        .action-btn.premium-feature::after {
            content: '✨';
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 12px;
            opacity: 0.8;
        }

        /* Top Navigation */
        .top-nav {
            background: #000000;
            border-bottom: 1px solid #ffd700;
            padding: 16px 24px;
            margin-left: 280px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .top-nav-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
        }

        .breadcrumb {
            color: #888;
            font-size: 14px;
        }

        .breadcrumb a {
            color: #ffd700;
            text-decoration: none;
        }

        .top-nav-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .notification-btn {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #ffd700;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .notification-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
        }

        .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: #ff4757;
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 5px;
            border-radius: 8px;
            min-width: 16px;
            text-align: center;
        }

        .logout-btn {
            background: transparent;
            color: #ffd700;
            border: 1px solid #ffd700;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .logout-btn:hover {
            background: #ffd700;
            color: #000000;
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 24px;
            font-weight: 800;
            color: #ffd700;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: 32px;
        }

        .nav-menu a {
            color: #ffd700;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-menu a:hover {
            color: #ffed4a;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #ffffff;
            font-weight: 500;
        }

        .logout-btn {
            background: transparent;
            color: #ffd700;
            border: 1px solid #ffd700;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #ffd700;
            color: #000000;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            min-height: 100vh;
            background: #000000;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        /* COMPREHENSIVE MOBILE UI IMPROVEMENTS */
        
        /* Small Mobile: up to 480px */
        @media (max-width: 480px) {
            .sidebar {
                width: 100%;
                transform: translateX(-100%);
                z-index: 2000;
            }

            .sidebar.mobile-visible {
                transform: translateX(0);
            }
            
            .sidebar-header {
                padding: 16px 20px 20px;
            }
            
            .sidebar-logo {
                font-size: 24px;
            }
            
            .user-avatar {
                width: 36px;
                height: 36px;
                font-size: 14px;
            }
            
            .user-name {
                font-size: 13px;
            }
            
            .user-role {
                font-size: 11px;
            }
            
            .nav-link {
                padding: 14px 20px;
                font-size: 14px;
            }
            
            .nav-icon {
                font-size: 16px;
                width: 24px;
            }

            .top-nav, 
            .main-content {
                margin-left: 0;
            }
            
            .top-nav {
                padding: 12px 16px;
            }

            .mobile-menu-btn {
                display: block;
                padding: 8px 12px;
                font-size: 18px;
                min-height: 44px;
                min-width: 44px;
            }
            
            .breadcrumb {
                font-size: 12px;
                display: none; /* Hide on very small screens */
            }

            .top-nav-right {
                gap: 8px;
            }
            
            .notification-btn {
                padding: 8px 10px;
                min-height: 44px;
                min-width: 44px;
            }

            .logout-btn {
                padding: 8px 12px;
                font-size: 12px;
                min-height: 44px;
            }
            
            .dashboard-container {
                padding: 16px 12px;
            }
            
            .welcome-title {
                font-size: 24px;
                line-height: 28px;
            }
            
            .welcome-subtitle {
                font-size: 14px;
            }
            
            .funding-progress {
                padding: 20px 16px;
                margin-bottom: 24px;
            }
            
            .funding-title {
                font-size: 18px;
                margin-bottom: 12px;
            }
            
            .funding-amount {
                font-size: 32px;
                line-height: 36px;
                margin-bottom: 6px;
            }
            
            .funding-target {
                font-size: 14px;
                margin-bottom: 20px;
            }
            
            .progress-stats {
                grid-template-columns: 1fr;
                gap: 16px;
                margin-top: 20px;
            }
            
            .progress-stat {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 0;
                border-bottom: 1px solid #333;
            }
            
            .progress-stat:last-child {
                border-bottom: none;
            }
            
            .progress-stat-value {
                font-size: 20px;
            }
            
            .progress-stat-label {
                font-size: 13px;
                text-align: left;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin-bottom: 24px;
            }
            
            .stat-card {
                padding: 16px 12px;
            }
            
            .stat-icon {
                font-size: 24px;
                margin-bottom: 8px;
            }
            
            .stat-value {
                font-size: 18px;
                margin-bottom: 4px;
            }
            
            .stat-label {
                font-size: 12px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
                margin-bottom: 24px;
            }
            
            .dashboard-card {
                padding: 16px;
            }
            
            .card-title {
                font-size: 16px;
            }
            
            .view-all-btn {
                font-size: 12px;
            }
            
            .investor-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
                padding: 12px 0;
            }
            
            .investor-info {
                width: 100%;
            }
            
            .investor-name {
                font-size: 14px;
            }
            
            .investor-title {
                font-size: 12px;
            }
            
            .investor-interest {
                font-size: 11px;
            }
            
            .investor-amount {
                align-self: flex-end;
                font-size: 14px;
                font-weight: 600;
            }
            
            .metric-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
                padding: 10px 0;
            }
            
            .metric-label {
                font-size: 13px;
            }
            
            .metric-value {
                font-size: 14px;
            }
            
            .update-item {
                gap: 10px;
                padding: 10px 0;
            }
            
            .update-icon {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }
            
            .update-text {
                font-size: 13px;
            }
            
            .update-time {
                font-size: 11px;
            }
            
            .action-grid {
                grid-template-columns: 1fr;
                gap: 12px;
                margin-top: 24px;
            }
            
            .action-btn {
                width: 100%;
                padding: 16px 20px;
                font-size: 14px;
                justify-content: center;
                min-height: 48px;
            }
        }
        
        /* Medium Mobile: 481px - 768px */
        @media (min-width: 481px) and (max-width: 768px) {
            .sidebar {
                width: 280px;
                transform: translateX(-100%);
            }

            .sidebar.mobile-visible {
                transform: translateX(0);
            }

            .top-nav, 
            .main-content {
                margin-left: 0;
            }
            
            .top-nav {
                padding: 14px 20px;
            }

            .mobile-menu-btn {
                display: block;
            }
            
            .breadcrumb {
                font-size: 13px;
            }

            .top-nav-right {
                gap: 12px;
            }

            .logout-btn {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .dashboard-container {
                padding: 24px 20px;
            }
            
            .welcome-title {
                font-size: 28px;
            }
            
            .funding-progress {
                padding: 28px 24px;
            }
            
            .funding-amount {
                font-size: 40px;
            }
            
            .progress-stats {
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .investor-item {
                flex-direction: row;
                gap: 16px;
            }
            
            .action-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
        }
        
        /* Touch-friendly improvements for all mobile devices */
        @media (max-width: 768px) {
            /* Ensure all interactive elements meet WCAG 2.1 AA minimum 44px touch target */
            .nav-link,
            .notification-btn,
            .logout-btn,
            .mobile-menu-btn,
            .action-btn,
            .investor-item {
                min-height: 44px;
                touch-action: manipulation;
            }
            
            /* Better focus styles for mobile */
            .nav-link:focus,
            .notification-btn:focus,
            .logout-btn:focus,
            .mobile-menu-btn:focus,
            .action-btn:focus {
                outline: 3px solid #ffd700;
                outline-offset: 2px;
            }
            
            /* Improve scrolling */
            .sidebar {
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* Add mobile-specific backdrop for sidebar */
            .sidebar.mobile-visible::before {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: rgba(0, 0, 0, 0.5);
                z-index: -1;
            }
        }

        .dashboard-header {
            margin-bottom: 40px;
        }

        .welcome-title {
            font-size: 32px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 8px;
        }

        .welcome-subtitle {
            color: #cccccc;
            font-size: 16px;
        }

        /* Funding Progress */
        .funding-progress {
            background: #1a1a1a;
            border: 1px solid #ffd700;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 40px;
            text-align: center;
        }

        .funding-title {
            font-size: 24px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 16px;
        }

        .funding-amount {
            font-size: 48px;
            font-weight: 800;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .funding-target {
            color: #cccccc;
            margin-bottom: 24px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #333;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ffed4a);
            border-radius: 6px;
            width: 68%;
            transition: width 0.3s ease;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-top: 24px;
        }

        .progress-stat {
            text-align: center;
        }

        .progress-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 4px;
        }

        .progress-stat-label {
            color: #cccccc;
            font-size: 14px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #ffd700;
            transform: translateY(-2px);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
            display: block;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #cccccc;
            font-size: 14px;
            font-weight: 500;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            margin-bottom: 40px;
        }

        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Card Styles */
        .dashboard-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 24px;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #ffffff;
        }

        .view-all-btn {
            color: #ffd700;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }

        .view-all-btn:hover {
            color: #ffed4a;
        }

        /* Investor Interest */
        .investor-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid #333;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .investor-item:last-child {
            border-bottom: none;
        }

        .investor-item:hover {
            background: rgba(255, 215, 0, 0.05);
            margin: 0 -24px;
            padding: 16px 24px;
            border-radius: 8px;
        }

        .investor-avatar {
            width: 48px;
            height: 48px;
            background: #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #000000;
            font-weight: 700;
        }

        .investor-info {
            flex: 1;
        }

        .investor-name {
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 4px;
        }

        .investor-title {
            color: #cccccc;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .investor-interest {
            color: #ffd700;
            font-size: 12px;
            font-weight: 500;
        }

        .investor-amount {
            text-align: right;
            color: #ffd700;
            font-weight: 600;
        }

        /* Business Metrics */
        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #333;
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-label {
            color: #cccccc;
            font-weight: 500;
        }

        .metric-value {
            color: #ffffff;
            font-weight: 600;
        }

        .metric-change {
            font-size: 12px;
            font-weight: 500;
            margin-left: 8px;
        }

        .positive {
            color: #10b981;
        }

        .negative {
            color: #ef4444;
        }

        /* Action Buttons */
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 40px;
        }

        .action-btn {
            background: #ffd700;
            color: #000000;
            border: none;
            padding: 16px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-btn:hover {
            background: #ffed4a;
            transform: translateY(-2px);
        }

        .action-btn.secondary {
            background: transparent;
            color: #ffd700;
            border: 1px solid #ffd700;
        }

        .action-btn.secondary:hover {
            background: #ffd700;
            color: #000000;
        }

        /* Recent Updates */
        .update-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #333;
        }

        .update-item:last-child {
            border-bottom: none;
        }

        .update-icon {
            width: 32px;
            height: 32px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffd700;
            font-size: 14px;
        }

        .update-content {
            flex: 1;
        }

        .update-text {
            color: #ffffff;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .update-time {
            color: #cccccc;
            font-size: 12px;
        }

        @media (max-width: 768px) {
            .dashboard-container {
                padding: 24px 16px;
            }
            
            .nav-menu {
                display: none;
            }
            
            .funding-amount {
                font-size: 36px;
            }
            
            .progress-stats {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .investor-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .investor-amount {
                align-self: flex-end;
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <!-- Left Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="index.html" class="sidebar-logo">Bvester</a>
            <div class="user-info">
                <div class="user-avatar">SE</div>
                <div class="user-details">
                    <div class="user-name">Sarah Entrepreneur</div>
                    <div class="user-role">Business Owner</div>
                </div>
            </div>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="section-title">Dashboard</div>
                <div class="nav-item">
                    <a href="startup-dashboard.html" class="nav-link active">
                        <span class="nav-icon">📊</span>
                        <span>Overview</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="business-profile.html" class="nav-link">
                        <span class="nav-icon">🏢</span>
                        <span>Business Profile</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="financial-records.html" class="nav-link">
                        <span class="nav-icon">📈</span>
                        <span>Financial Records</span>
                    </a>
                </div>
            </div>

            <div class="nav-section">
                <div class="section-title">Fundraising</div>
                <div class="nav-item">
                    <a href="ai-matchmaking.html" class="nav-link">
                        <span class="nav-icon">🤖</span>
                        <span>AI Investor Matching</span>
                        <span class="nav-badge">New</span>
                        <span class="premium-icon">👑</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="list-for-funding.html" class="nav-link premium-feature">
                        <span class="nav-icon">🚀</span>
                        <span>List for Funding</span>
                        <span class="premium-icon">👑</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="portfolio-management.html" class="nav-link">
                        <span class="nav-icon">📋</span>
                        <span>Campaign Management</span>
                        <span class="premium-icon">👑</span>
                    </a>
                </div>
            </div>

            <div class="nav-section">
                <div class="section-title">Communication</div>
                <div class="nav-item">
                    <a href="message-investors.html" class="nav-link">
                        <span class="nav-icon">💬</span>
                        <span>Investor Messages</span>
                        <span class="nav-badge">5</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="growth-hub.html" class="nav-link">
                        <span class="nav-icon">📚</span>
                        <span>Growth Resources</span>
                    </a>
                </div>
            </div>

            <div class="nav-section">
                <div class="section-title">Impact & Growth</div>
                <div class="nav-item">
                    <a href="esg-impact-scoring.html" class="nav-link">
                        <span class="nav-icon">🌍</span>
                        <span>ESG Impact Score</span>
                        <span class="premium-icon">👑</span>
                    </a>
                </div>
            </div>

            <div class="nav-section">
                <div class="section-title">Account</div>
                <div class="nav-item">
                    <a href="payments-subscriptions.html" class="nav-link">
                        <span class="nav-icon">💳</span>
                        <span>Subscription</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="business-settings.html" class="nav-link">
                        <span class="nav-icon">⚙️</span>
                        <span>Settings</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="index.html" class="nav-link">
                        <span class="nav-icon">🚪</span>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </nav>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Top Navigation -->
        <div class="top-nav">
            <div class="top-nav-left">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">☰</button>
                <div class="breadcrumb">
                    <a href="index.html">Home</a> / <span>Business Dashboard</span>
                </div>
            </div>
            <div class="top-nav-right">
                <button class="notification-btn">
                    🔔
                    <span class="notification-badge">5</span>
                </button>
                <a href="index.html" class="logout-btn">Logout</a>
            </div>
        </div>

    <!-- Main Content -->
    <div class="dashboard-container">
        <!-- Header -->
        <div class="dashboard-header">
            <h1 class="welcome-title">Welcome back, Sarah!</h1>
            <p class="welcome-subtitle">Here's how your funding campaign is performing</p>
        </div>

        <!-- Funding Progress -->
        <div class="funding-progress">
            <h2 class="funding-title">Current Funding Round</h2>
            <div class="funding-amount">$0</div>
            <div class="funding-target">of $0 target • Not Started</div>
            
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            
            <div class="progress-stats">
                <div class="progress-stat">
                    <div class="progress-stat-value">68%</div>
                    <div class="progress-stat-label">Funded</div>
                </div>
                <div class="progress-stat">
                    <div class="progress-stat-value">42</div>
                    <div class="progress-stat-label">Investors</div>
                </div>
                <div class="progress-stat">
                    <div class="progress-stat-value">28</div>
                    <div class="progress-stat-label">Days Left</div>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-icon">👥</span>
                <div class="stat-value">847</div>
                <div class="stat-label">Profile Views</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">💌</span>
                <div class="stat-value">23</div>
                <div class="stat-label">Investor Inquiries</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">📊</span>
                <div class="stat-value">9.2</div>
                <div class="stat-label">Investment Score</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">🔥</span>
                <div class="stat-value">156</div>
                <div class="stat-label">Followers</div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Investor Interest -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2 class="card-title">💰 Investor Interest</h2>
                    <a href="investors.html" class="view-all-btn">View All →</a>
                </div>
                
                <div class="investor-item" onclick="viewInvestor('john-smith')">
                    <div class="investor-avatar">JS</div>
                    <div class="investor-info">
                        <div class="investor-name">John Smith</div>
                        <div class="investor-title">Angel Investor • Tech Ventures</div>
                        <div class="investor-interest">Interested in Series A • Fintech Focus</div>
                    </div>
                    <div class="investor-amount">$50K</div>
                </div>

                <div class="investor-item" onclick="viewInvestor('african-vc')">
                    <div class="investor-avatar">AV</div>
                    <div class="investor-info">
                        <div class="investor-name">African Ventures</div>
                        <div class="investor-title">Venture Capital • Lagos</div>
                        <div class="investor-interest">Looking at growth stage opportunities</div>
                    </div>
                    <div class="investor-amount">$100K</div>
                </div>

                <div class="investor-item" onclick="viewInvestor('global-fund')">
                    <div class="investor-avatar">GF</div>
                    <div class="investor-info">
                        <div class="investor-name">Global Impact Fund</div>
                        <div class="investor-title">Impact Investor • International</div>
                        <div class="investor-interest">ESG-focused investments</div>
                    </div>
                    <div class="investor-amount">$75K</div>
                </div>

                <div class="investor-item" onclick="viewInvestor('maria-dev')">
                    <div class="investor-avatar">MD</div>
                    <div class="investor-info">
                        <div class="investor-name">Maria Developer</div>
                        <div class="investor-title">Individual Investor • Tech Background</div>
                        <div class="investor-interest">Early stage tech investments</div>
                    </div>
                    <div class="investor-amount">$25K</div>
                </div>
            </div>

            <!-- Sidebar -->
            <div>
                <!-- Business Metrics -->
                <div class="dashboard-card" style="margin-bottom: 24px;">
                    <div class="card-header">
                        <h2 class="card-title">📈 Business Metrics</h2>
                        <a href="analytics.html" class="view-all-btn">View Details →</a>
                    </div>
                    
                    <div class="metric-item">
                        <div class="metric-label">Monthly Revenue</div>
                        <div class="metric-value">
                            $45,200
                            <span class="metric-change positive">+12.5%</span>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Customer Growth</div>
                        <div class="metric-value">
                            2,847
                            <span class="metric-change positive">+8.3%</span>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Burn Rate</div>
                        <div class="metric-value">
                            $28,500
                            <span class="metric-change negative">+5.2%</span>
                        </div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Runway</div>
                        <div class="metric-value">18 months</div>
                    </div>

                    <div class="metric-item">
                        <div class="metric-label">Valuation</div>
                        <div class="metric-value">$2.5M</div>
                    </div>
                </div>

                <!-- Recent Updates -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2 class="card-title">🔔 Recent Updates</h2>
                    </div>
                    
                    <div class="update-item">
                        <div class="update-icon">💰</div>
                        <div class="update-content">
                            <div class="update-text">New $50K investment from John Smith</div>
                            <div class="update-time">2 hours ago</div>
                        </div>
                    </div>

                    <div class="update-item">
                        <div class="update-icon">📊</div>
                        <div class="update-content">
                            <div class="update-text">Monthly revenue report updated</div>
                            <div class="update-time">1 day ago</div>
                        </div>
                    </div>

                    <div class="update-item">
                        <div class="update-icon">👥</div>
                        <div class="update-content">
                            <div class="update-text">5 new investor profile views</div>
                            <div class="update-time">2 days ago</div>
                        </div>
                    </div>

                    <div class="update-item">
                        <div class="update-icon">💌</div>
                        <div class="update-content">
                            <div class="update-text">Message from African Ventures VC</div>
                            <div class="update-time">3 days ago</div>
                        </div>
                    </div>

                    <div class="update-item">
                        <div class="update-icon">🎯</div>
                        <div class="update-content">
                            <div class="update-text">Featured in FinTech Weekly newsletter</div>
                            <div class="update-time">1 week ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="action-grid">
            <a href="post-campaign-update.html" class="action-btn">
                📝 Post Campaign Update
            </a>
            <a href="upload-docs.html" class="action-btn secondary">
                📄 Upload Documents
            </a>
            <a href="update-financial-data.html" class="action-btn secondary">
                📊 Update Financial Data
            </a>
            <a href="message-investors.html" class="action-btn secondary">
                💌 Message Investors
            </a>
            <a href="financial-records.html" class="action-btn secondary">
                📊 Financial Records
            </a>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    
    <!-- Bvester API Client -->
    <script src="js/api-client.js"></script>
    
    <!-- Authentication Guard -->
    <script src="js/auth-guard.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            projectId: "bizinvest-hub-prod",
            appId: "1:19849690024:web:134ceb9fc20fec428a3b9d",
            storageBucket: "bizinvest-hub-prod.firebasestorage.app",
            apiKey: "AIzaSyAdTIb1Hpue64ZqzkcsjlTWP747TW_CJ80",
            authDomain: "bizinvest-hub-prod.firebaseapp.com",
            messagingSenderId: "19849690024",
            measurementId: "G-3M77VNP2YC"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        let currentUser = null;
        let businessData = null;
        let investorInterests = [];

        // Real logout functionality  
        async function logout() {
            try {
                await bvesterAPI.logout();
                window.location.href = 'index.html';
            } catch (error) {
                console.error('Logout error:', error);
                alert('Error logging out. Please try again.');
            }
        }

        // Update all logout links to use real logout
        function updateLogoutLinks() {
            const logoutLinks = document.querySelectorAll('a[href="index.html"]:not(.sidebar-logo)');
            logoutLinks.forEach(link => {
                if (link.textContent.includes('Logout') || link.classList.contains('logout-btn')) {
                    link.removeAttribute('href');
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        logout();
                    });
                    link.style.cursor = 'pointer';
                }
            });
        }

        // Load real business dashboard data

        async function loadDashboardData() {
            try {
                showLoadingState();
                console.log('📊 Loading startup dashboard data...');

                let businessData = null;
                let investorInterests = [];
                let hasErrors = false;

                // Enhanced error handling for business data loading
                try {
                    console.log('🏢 Loading business analytics...');
                    
                    // Check if user exists first
                    if (!currentUser || !currentUser.uid) {
                        throw new Error('User not authenticated or UID missing');
                    }
                    
                    console.log('🔍 Using User ID:', currentUser.uid);
                    const businessResponse = await bvesterAPI.getBusinessAnalytics(currentUser.uid);
                    
                    console.log('📡 Business response:', businessResponse);
                    
                    if (businessResponse && businessResponse.success && businessResponse.data) {
                        businessData = businessResponse.data;
                        console.log('✅ Business data loaded successfully:', businessData);
                    } else {
                        console.warn('⚠️ Business analytics response not successful, creating default');
                        console.log('Response details:', businessResponse);
                        businessData = await createDefaultBusinessData();
                    }
                } catch (businessError) {
                    console.error('❌ Error loading business data:', businessError);
                    console.log('🔧 Creating default business data due to error...');
                    
                    // Try to create default data, but don't fail if that fails too
                    try {
                        businessData = await createDefaultBusinessData();
                        console.log('✅ Default business data created successfully');
                    } catch (defaultError) {
                        console.error('❌ Failed to create default data:', defaultError);
                        // Use minimal fallback data
                        businessData = {
                            basicInfo: {
                                businessName: 'Your Business',
                                industry: 'Technology'
                            },
                            investment: {
                                currentRound: {
                                    raisedAmount: 0,
                                    targetAmount: 100000,
                                    fundingStage: 'Seed',
                                    investorCount: 0,
                                    endDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString()
                                }
                            },
                            metrics: {
                                monthlyRevenue: 0,
                                userGrowth: 0,
                                marketSize: 'N/A'
                            }
                        };
                    }
                    hasErrors = true;
                }

                // Enhanced error handling for investor data loading
                try {
                    console.log('🤝 Loading matched investors...');
                    
                    if (currentUser && currentUser.uid) {
                        const investorsResponse = await bvesterAPI.getMatchedInvestors(currentUser.uid);
                        console.log('📡 Investors response:', investorsResponse);
                        
                        if (investorsResponse && investorsResponse.success && investorsResponse.data) {
                            investorInterests = investorsResponse.data || [];
                            console.log('✅ Investor interests loaded successfully:', investorInterests.length, 'interests');
                        } else {
                            console.warn('⚠️ No investor interests found or unsuccessful response');
                            investorInterests = [];
                        }
                    } else {
                        console.warn('⚠️ Cannot load investors - user not authenticated');
                        investorInterests = [];
                    }
                } catch (investorError) {
                    console.error('❌ Error loading investors:', investorError);
                    investorInterests = [];
                    hasErrors = true;
                }

                // Update dashboard with loaded data (with individual error handling)
                try {
                    if (businessData) {
                        console.log('🔄 Updating dashboard components...');
                        
                        try {
                            updateBusinessProfile(businessData);
                            console.log('✅ Business profile updated');
                        } catch (profileError) {
                            console.error('❌ Error updating business profile:', profileError);
                        }
                        
                        try {
                            updateFundingProgress(businessData);
                            console.log('✅ Funding progress updated');
                        } catch (fundingError) {
                            console.error('❌ Error updating funding progress:', fundingError);
                        }
                        
                        try {
                            updateBusinessMetrics(businessData);
                            console.log('✅ Business metrics updated');
                        } catch (metricsError) {
                            console.error('❌ Error updating business metrics:', metricsError);
                        }
                    } else {
                        console.warn('⚠️ No business data available to update dashboard');
                        // Load minimal dashboard without data
                        loadMinimalDashboard();
                    }

                    try {
                        updateInvestorInterests(investorInterests);
                        console.log('✅ Investor interests updated');
                    } catch (investorUpdateError) {
                        console.error('❌ Error updating investor interests:', investorUpdateError);
                    }

                    if (hasErrors) {
                        showWarningBanner('Some data could not be loaded. Dashboard is showing default values.');
                    }

                    console.log('✅ Startup dashboard loaded successfully with fallbacks if needed');

                } catch (updateError) {
                    console.error('❌ Error updating dashboard components:', updateError);
                    // Don't crash - try to load minimal dashboard
                    loadMinimalDashboard();
                    showWarningBanner('Dashboard loaded with limited functionality due to data loading issues.');
                }

            } catch (error) {
                console.error('❌ Critical error loading dashboard data:', error);
                
                // Instead of showing error state, try to load minimal dashboard
                try {
                    console.log('🔧 Attempting to load minimal dashboard as fallback...');
                    loadMinimalDashboard();
                    showWarningBanner('Dashboard loaded in offline mode. Some features may be limited.');
                } catch (minimalError) {
                    console.error('❌ Even minimal dashboard failed:', minimalError);
                    showErrorStateWithRecovery('Unable to load dashboard. Please check your internet connection.');
                }
            } finally {
                hideLoadingState();
            }
        }

        function loadMinimalDashboard() {
            console.log('🔧 Loading minimal dashboard...');
            
            try {
                // Update with minimal default data
                const minimalData = {
                    basicInfo: {
                        businessName: currentUser?.displayName || currentUser?.email?.split('@')[0] || 'Your Business',
                        industry: 'Technology'
                    },
                    investment: {
                        currentRound: {
                            raisedAmount: 0,
                            targetAmount: 100000,
                            fundingStage: 'Seed',
                            investorCount: 0,
                            endDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString()
                        }
                    },
                    metrics: {
                        monthlyRevenue: 0,
                        userGrowth: 0,
                        marketSize: 'N/A'
                    }
                };

                // Update each component safely
                try { updateBusinessProfile(minimalData); } catch (e) { console.error('Profile update failed:', e); }
                try { updateFundingProgress(minimalData); } catch (e) { console.error('Funding update failed:', e); }
                try { updateBusinessMetrics(minimalData); } catch (e) { console.error('Metrics update failed:', e); }
                try { updateInvestorInterests([]); } catch (e) { console.error('Investor update failed:', e); }

                console.log('✅ Minimal dashboard loaded successfully');
            } catch (error) {
                console.error('❌ Failed to load minimal dashboard:', error);
                throw error; // Re-throw to be caught by caller
            }
        }

        function showLoadingState() {
            // Show loading indicators
            const statValues = document.querySelectorAll('.stat-value');
            statValues.forEach(stat => {
                stat.innerHTML = '<div style="color: #ffd700;">⏳</div>';
            });

            document.querySelector('.funding-amount').innerHTML = '<div style="color: #ffd700;">⏳</div>';
        }

        function hideLoadingState() {
            // Loading states will be replaced by real data
        }

        async function createDefaultBusinessData() {
            try {
                console.log('🏗️ Creating default business data for new user...');
                const db = firebase.firestore();
                
                const defaultBusiness = {
                    ownerId: currentUser.uid,
                    businessName: currentUser.bvesterData?.companyName || `${currentUser.bvesterData?.firstName || 'Your'} Business`,
                    industry: currentUser.bvesterData?.industry || 'Technology',
                    description: 'Complete your business profile to attract investors',
                    basicInfo: {
                        businessName: currentUser.bvesterData?.companyName || `${currentUser.bvesterData?.firstName || 'Your'} Business`,
                        industry: currentUser.bvesterData?.industry || 'Technology'
                    },
                    investment: {
                        currentRound: {
                            raisedAmount: 0,
                            targetAmount: 100000,
                            fundingStage: 'Seed',
                            investorCount: 0,
                            endDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString() // 90 days from now
                        }
                    },
                    analytics: {
                        profileViews: 0,
                        investorInquiries: 0,
                        investmentScore: 7.5,
                        followers: 0,
                        customerCount: 0,
                        customerGrowth: 0
                    },
                    financials: {
                        monthlyRevenue: 0,
                        revenueGrowth: 0,
                        burnRate: 0,
                        burnRateChange: 0,
                        runway: 12,
                        valuation: 0
                    },
                    status: {
                        isPublished: false,
                        isActive: true,
                        fundingStatus: 'planning'
                    },
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                // Save to Firestore for future use
                await db.collection('businesses').doc(currentUser.uid).set(defaultBusiness, { merge: true });
                console.log('✅ Default business data created and saved');
                
                return defaultBusiness;
            } catch (error) {
                console.error('❌ Error creating default business data:', error);
                // Return minimal fallback data even if Firestore fails
                return {
                    basicInfo: {
                        businessName: currentUser.bvesterData?.companyName || 'Your Business'
                    },
                    investment: {
                        currentRound: {
                            raisedAmount: 0,
                            targetAmount: 100000,
                            fundingStage: 'Seed',
                            investorCount: 0
                        }
                    },
                    analytics: {
                        profileViews: 0,
                        investorInquiries: 0,
                        investmentScore: 7.5,
                        followers: 0
                    },
                    financials: {
                        monthlyRevenue: 0,
                        revenueGrowth: 0,
                        burnRate: 0,
                        runway: 12,
                        valuation: 0
                    }
                };
            }
        }

        function showWarningBanner(message) {
            const warningBanner = document.createElement('div');
            warningBanner.innerHTML = `
                <div style="
                    background: linear-gradient(90deg, #ffa500, #ff8c00);
                    color: #000;
                    padding: 12px 24px;
                    text-align: center;
                    font-size: 14px;
                    font-weight: 500;
                    margin-bottom: 20px;
                    border-radius: 8px;
                    border: 1px solid #ff8c00;
                ">
                    ⚠️ ${message}
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: none;
                        border: none;
                        color: #000;
                        font-size: 16px;
                        font-weight: bold;
                        float: right;
                        cursor: pointer;
                        margin-left: 10px;
                    ">✕</button>
                </div>
            `;
            document.querySelector('.dashboard-container').insertBefore(warningBanner, document.querySelector('.dashboard-header'));
        }

        function showErrorStateWithRecovery(errorMessage) {
            const dashboardContainer = document.querySelector('.dashboard-container');
            dashboardContainer.innerHTML = `
                <div style="text-align: center; padding: 60px;">
                    <div style="color: #ff4444; font-size: 48px; margin-bottom: 16px;">⚠️</div>
                    <div style="color: #ffffff; font-size: 18px; margin-bottom: 8px;">Dashboard Loading Error</div>
                    <div style="color: #cccccc; font-size: 14px; margin-bottom: 24px;">We're having trouble loading your dashboard data.</div>
                    <div style="color: #888; font-size: 12px; margin-bottom: 32px;">Error: ${errorMessage}</div>
                    
                    <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                        <button onclick="retryDashboardLoad()" style="
                            background: #ffd700;
                            color: #000;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 8px;
                            font-weight: 600;
                            cursor: pointer;
                            margin: 4px;
                        ">🔄 Retry Loading</button>
                        
                        <button onclick="loadDashboardWithDefaults()" style="
                            background: transparent;
                            color: #ffd700;
                            border: 2px solid #ffd700;
                            padding: 12px 24px;
                            border-radius: 8px;
                            font-weight: 600;
                            cursor: pointer;
                            margin: 4px;
                        ">📊 Load Default Dashboard</button>
                        
                        <button onclick="window.location.href='business-profile.html'" style="
                            background: transparent;
                            color: #ffd700;
                            border: 2px solid #ffd700;
                            padding: 12px 24px;
                            border-radius: 8px;
                            font-weight: 600;
                            cursor: pointer;
                            margin: 4px;
                        ">🏢 Complete Profile</button>
                    </div>
                    
                    <div style="color: #888; font-size: 12px; margin-top: 24px;">
                        If this problem persists, try completing your business profile or contact support.
                    </div>
                </div>
            `;
        }

        function updateUserInfo(user) {
            const userName = document.querySelector('.user-name');
            const userAvatar = document.querySelector('.user-avatar');
            const welcomeTitle = document.querySelector('.welcome-title');

            if (user && user.bvesterData) {
                const displayName = user.bvesterData.profile?.displayName || 
                                  `${user.bvesterData.firstName || ''} ${user.bvesterData.lastName || ''}`.trim() ||
                                  user.email.split('@')[0];
                
                userName.textContent = displayName;
                welcomeTitle.textContent = `Welcome back, ${displayName.split(' ')[0]}!`;
                userAvatar.textContent = displayName.charAt(0).toUpperCase();
            }
        }

        function updateBusinessProfile(business) {
            if (!business) return;

            // Update welcome subtitle with business name
            const welcomeSubtitle = document.querySelector('.welcome-subtitle');
            const businessName = business.basicInfo?.businessName || 'your business';
            welcomeSubtitle.textContent = `Here's how ${businessName} is performing`;
        }

        function updateFundingProgress(business) {
            if (!business || !business.investment) return;

            const currentRound = business.investment.currentRound || {};
            const raisedAmount = currentRound.raisedAmount || 0;
            const targetAmount = currentRound.targetAmount || 0;
            const fundingStage = currentRound.fundingStage || 'Seed';
            const investorCount = currentRound.investorCount || 0;
            const daysLeft = currentRound.endDate ? 
                Math.max(0, Math.ceil((new Date(currentRound.endDate) - new Date()) / (1000 * 60 * 60 * 24))) : 0;

            // Update funding progress section
            document.querySelector('.funding-title').textContent = `Current Funding Round - ${fundingStage}`;
            document.querySelector('.funding-amount').textContent = formatCurrency(raisedAmount);
            document.querySelector('.funding-target').textContent = `of ${formatCurrency(targetAmount)} target • ${fundingStage}`;

            // Update progress bar
            const progressPercent = targetAmount > 0 ? (raisedAmount / targetAmount) * 100 : 0;
            const progressBar = document.querySelector('.progress-fill');
            setTimeout(() => {
                progressBar.style.width = `${Math.min(progressPercent, 100)}%`;
            }, 500);

            // Update progress stats
            const progressStats = document.querySelectorAll('.progress-stat-value');
            if (progressStats[0]) progressStats[0].textContent = `${progressPercent.toFixed(0)}%`;
            if (progressStats[1]) progressStats[1].textContent = investorCount.toString();
            if (progressStats[2]) progressStats[2].textContent = daysLeft.toString();
        }

        function updateBusinessMetrics(business) {
            if (!business) return;

            const analytics = business.analytics || {};
            const financials = business.financials || {};

            // Update stat cards
            const statCards = document.querySelectorAll('.stat-card');
            
            if (statCards[0]) {
                statCards[0].querySelector('.stat-value').textContent = analytics.profileViews || 0;
            }
            
            if (statCards[1]) {  
                statCards[1].querySelector('.stat-value').textContent = analytics.investorInquiries || 0;
            }
            
            if (statCards[2]) {
                const investmentScore = analytics.investmentScore || (Math.random() * 10).toFixed(1);
                statCards[2].querySelector('.stat-value').textContent = investmentScore;
            }
            
            if (statCards[3]) {
                statCards[3].querySelector('.stat-value').textContent = analytics.followers || 0;
            }

            // Update business metrics in sidebar
            const metricItems = document.querySelectorAll('.metric-item');
            
            if (metricItems[0]) {
                const monthlyRevenue = financials.monthlyRevenue || 0;
                const revenueGrowth = financials.revenueGrowth || 0;
                metricItems[0].querySelector('.metric-value').innerHTML = `
                    ${formatCurrency(monthlyRevenue)}
                    <span class="metric-change ${revenueGrowth >= 0 ? 'positive' : 'negative'}">
                        ${revenueGrowth >= 0 ? '+' : ''}${revenueGrowth.toFixed(1)}%
                    </span>
                `;
            }

            if (metricItems[1]) {
                const customerCount = analytics.customerCount || 0;
                const customerGrowth = analytics.customerGrowth || 0;
                metricItems[1].querySelector('.metric-value').innerHTML = `
                    ${customerCount.toLocaleString()}
                    <span class="metric-change ${customerGrowth >= 0 ? 'positive' : 'negative'}">
                        ${customerGrowth >= 0 ? '+' : ''}${customerGrowth.toFixed(1)}%
                    </span>
                `;
            }

            if (metricItems[2]) {
                const burnRate = financials.burnRate || 0;
                const burnChange = financials.burnRateChange || 0;
                metricItems[2].querySelector('.metric-value').innerHTML = `
                    ${formatCurrency(burnRate)}
                    <span class="metric-change ${burnChange <= 0 ? 'positive' : 'negative'}">
                        ${burnChange >= 0 ? '+' : ''}${burnChange.toFixed(1)}%
                    </span>
                `;
            }

            if (metricItems[3]) {
                const runway = financials.runway || 0;
                metricItems[3].querySelector('.metric-value').textContent = `${runway} months`;
            }

            if (metricItems[4]) {
                const valuation = financials.valuation || 0;
                metricItems[4].querySelector('.metric-value').textContent = formatCurrency(valuation);
            }
        }

        function updateInvestorInterests(interests) {
            if (!interests || interests.length === 0) {
                const investorContainer = document.querySelector('.dashboard-card .investor-item').parentElement;
                investorContainer.innerHTML = `
                    <div class="card-header">
                        <h2 class="card-title">💰 Investor Interest</h2>
                        <a href="ai-matchmaking.html" class="view-all-btn">Find Investors →</a>
                    </div>
                    <div style="text-align: center; padding: 40px; color: #cccccc;">
                        <div style="font-size: 48px; margin-bottom: 16px;">🔍</div>
                        <div>No investor interests yet</div>
                        <div style="font-size: 14px; margin-top: 8px;">Use our AI matching to find potential investors</div>
                    </div>
                `;
                return;
            }

            const investorContainer = document.querySelector('.dashboard-card .investor-item').parentElement;
            investorContainer.innerHTML = `
                <div class="card-header">
                    <h2 class="card-title">💰 Investor Interest</h2>
                    <a href="message-investors.html" class="view-all-btn">View All →</a>
                </div>
            `;

            interests.slice(0, 4).forEach(interest => {
                const investorItem = document.createElement('div');
                investorItem.className = 'investor-item';
                investorItem.onclick = () => viewInvestor(interest.investorId);
                
                const investorName = interest.investorInfo?.name || 'Anonymous Investor';
                const investorTitle = interest.investorInfo?.title || 'Private Investor';
                const investorType = interest.investorInfo?.type || 'Individual';
                const interestAmount = interest.potentialAmount || 0;
                const avatar = investorName.split(' ').map(n => n.charAt(0)).join('').toUpperCase();

                investorItem.innerHTML = `
                    <div class="investor-avatar">${avatar}</div>
                    <div class="investor-info">
                        <div class="investor-name">${investorName}</div>
                        <div class="investor-title">${investorTitle} • ${investorType}</div>
                        <div class="investor-interest">${interest.interestLevel || 'Interested'} • ${interest.focusArea || 'General'}</div>
                    </div>
                    <div class="investor-amount">${formatCurrency(interestAmount)}</div>
                `;

                investorContainer.appendChild(investorItem);
            });
        }

        function formatCurrency(amount, currency = 'USD') {
            if (amount >= 1000000) return `$${(amount / 1000000).toFixed(1)}M`;
            if (amount >= 1000) return `$${(amount / 1000).toFixed(0)}K`;
            return `$${amount.toLocaleString()}`;
        }

        function viewInvestor(id) {
            // Navigate to investor communication page
            window.location.href = `message-investors.html?investor=${id}`;
        }

        // Real-time updates
        function startRealTimeUpdates() {
            setInterval(async () => {
                try {
                    // Update business analytics
                    const analyticsResponse = await bvesterAPI.getBusinessAnalytics(currentUser.uid);
                    if (analyticsResponse.success) {
                        updateBusinessMetrics(analyticsResponse.data);
                        
                        // Add subtle animation to indicate live updates
                        const statValues = document.querySelectorAll('.stat-value');
                        statValues.forEach(stat => {
                            stat.style.transform = 'scale(1.02)';
                            setTimeout(() => {
                                stat.style.transform = 'scale(1)';
                            }, 200);
                        });
                    }
                } catch (error) {
                    console.error('Error updating real-time data:', error);
                }
            }, 60000); // Update every minute
        }

        // Mobile sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('mobile-visible');
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const menuBtn = document.querySelector('.mobile-menu-btn');
            
            if (window.innerWidth <= 768 && 
                !sidebar.contains(event.target) && 
                !menuBtn.contains(event.target)) {
                sidebar.classList.remove('mobile-visible');
            }
        });

        // Recovery functions for error states
        async function retryDashboardLoad() {
            try {
                console.log('🔄 Retrying dashboard load...');
                
                // Reset the dashboard container to original state
                location.reload();
            } catch (error) {
                console.error('❌ Retry failed:', error);
                alert('Retry failed. Please refresh the page manually.');
            }
        }

        async function loadDashboardWithDefaults() {
            try {
                console.log('📊 Loading dashboard with default data...');
                
                // Create the default dashboard structure
                const dashboardContainer = document.querySelector('.dashboard-container');
                if (!dashboardContainer) {
                    location.reload();
                    return;
                }
                
                // Show loading state
                showLoadingState();
                
                // Create default business data
                const defaultData = await createDefaultBusinessData();
                
                // Reset dashboard container to original structure
                dashboardContainer.innerHTML = `
                    <!-- Header -->
                    <div class="dashboard-header">
                        <h1 class="welcome-title">Welcome back!</h1>
                        <p class="welcome-subtitle">Here's your business dashboard with default values</p>
                    </div>

                    <!-- Warning Banner -->
                    <div style="
                        background: linear-gradient(90deg, #ffa500, #ff8c00);
                        color: #000;
                        padding: 16px 24px;
                        text-align: center;
                        font-size: 14px;
                        font-weight: 500;
                        margin-bottom: 20px;
                        border-radius: 8px;
                        border: 1px solid #ff8c00;
                    ">
                        ⚠️ Dashboard loaded with default values. Complete your business profile to see real data.
                        <a href="business-profile.html" style="color: #000; font-weight: 600; text-decoration: underline; margin-left: 10px;">Complete Profile →</a>
                    </div>

                    <!-- Rest of dashboard content -->
                    <div class="funding-progress">
                        <h2 class="funding-title">Current Funding Round - Seed</h2>
                        <div class="funding-amount">$0</div>
                        <div class="funding-target">of $100,000 target • Seed</div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%;"></div>
                        </div>
                        
                        <div class="progress-stats">
                            <div class="progress-stat">
                                <div class="progress-stat-value">0%</div>
                                <div class="progress-stat-label">Funded</div>
                            </div>
                            <div class="progress-stat">
                                <div class="progress-stat-value">0</div>
                                <div class="progress-stat-label">Investors</div>
                            </div>
                            <div class="progress-stat">
                                <div class="progress-stat-value">90</div>
                                <div class="progress-stat-label">Days Left</div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="stat-icon">👥</span>
                            <div class="stat-value">0</div>
                            <div class="stat-label">Profile Views</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">💌</span>
                            <div class="stat-value">0</div>
                            <div class="stat-label">Investor Inquiries</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">📊</span>
                            <div class="stat-value">7.5</div>
                            <div class="stat-label">Investment Score</div>
                        </div>
                        <div class="stat-card">
                            <span class="stat-icon">🔥</span>
                            <div class="stat-value">0</div>
                            <div class="stat-label">Followers</div>
                        </div>
                    </div>

                    <!-- Dashboard Grid -->
                    <div class="dashboard-grid">
                        <!-- Investor Interest -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h2 class="card-title">💰 Investor Interest</h2>
                                <a href="ai-matchmaking.html" class="view-all-btn">Find Investors →</a>
                            </div>
                            <div style="text-align: center; padding: 40px; color: #cccccc;">
                                <div style="font-size: 48px; margin-bottom: 16px;">🔍</div>
                                <div>No investor interests yet</div>
                                <div style="font-size: 14px; margin-top: 8px;">Complete your profile to attract investors</div>
                            </div>
                        </div>

                        <!-- Sidebar -->
                        <div>
                            <!-- Business Metrics -->
                            <div class="dashboard-card" style="margin-bottom: 24px;">
                                <div class="card-header">
                                    <h2 class="card-title">📈 Business Metrics</h2>
                                    <a href="financial-records.html" class="view-all-btn">Add Data →</a>
                                </div>
                                
                                <div class="metric-item">
                                    <div class="metric-label">Monthly Revenue</div>
                                    <div class="metric-value">$0</div>
                                </div>

                                <div class="metric-item">
                                    <div class="metric-label">Customer Growth</div>
                                    <div class="metric-value">0</div>
                                </div>

                                <div class="metric-item">
                                    <div class="metric-label">Burn Rate</div>
                                    <div class="metric-value">$0</div>
                                </div>

                                <div class="metric-item">
                                    <div class="metric-label">Runway</div>
                                    <div class="metric-value">12 months</div>
                                </div>

                                <div class="metric-item">
                                    <div class="metric-label">Valuation</div>
                                    <div class="metric-value">$0</div>
                                </div>
                            </div>

                            <!-- Recent Updates -->
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h2 class="card-title">🔔 Recent Updates</h2>
                                </div>
                                
                                <div class="update-item">
                                    <div class="update-icon">🎉</div>
                                    <div class="update-content">
                                        <div class="update-text">Welcome to Bvester! Complete your profile to get started.</div>
                                        <div class="update-time">Just now</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="action-grid">
                        <a href="business-profile.html" class="action-btn">
                            🏢 Complete Business Profile
                        </a>
                        <a href="financial-records.html" class="action-btn secondary">
                            📊 Add Financial Data
                        </a>
                        <a href="list-for-funding.html" class="action-btn secondary premium-feature">
                            🚀 List for Funding
                        </a>
                        <a href="ai-matchmaking.html" class="action-btn secondary">
                            🤖 Find Investors
                        </a>
                    </div>
                `;
                
                // Update user info
                updateUserInfo(currentUser);
                
                hideLoadingState();
                
                console.log('✅ Default dashboard loaded successfully');
                
            } catch (error) {
                console.error('❌ Error loading default dashboard:', error);
                alert('Unable to load dashboard. Please refresh the page.');
            }
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                console.log('🚀 Initializing startup dashboard...');
                
                // Initialize authentication with retry logic
                let authRetries = 0;
                const maxAuthRetries = 3;
                
                while (authRetries < maxAuthRetries) {
                    try {
                        await bvesterAPI.initializeAuth();
                        break;
                    } catch (authError) {
                        authRetries++;
                        console.warn(`⚠️ Auth initialization attempt ${authRetries} failed:`, authError);
                        if (authRetries < maxAuthRetries) {
                            await new Promise(resolve => setTimeout(resolve, 2000)); // Wait 2 seconds
                        } else {
                            throw authError;
                        }
                    }
                }
                
                // Check if user is logged in and is a business owner
                if (!bvesterAPI.currentUser) {
                    console.log('❌ No authenticated user found, redirecting to login');
                    window.location.href = 'login.html';
                    return;
                }

                const userType = bvesterAPI.currentUser.bvesterData?.userType;
                console.log('👤 Business dashboard: User type detected as:', userType);
                
                if (userType !== 'business' && userType !== 'startup') {
                    console.warn('❌ Access denied: User type not business or startup');
                    alert('This dashboard is only available for business accounts. Redirecting to the correct dashboard.');
                    
                    // Redirect to correct dashboard based on user type
                    if (userType === 'investor') {
                        window.location.href = 'investor-dashboard.html';
                    } else {
                        window.location.href = 'index.html';
                    }
                    return;
                }
                
                console.log('✅ Access granted: User is business/startup type');
                currentUser = bvesterAPI.currentUser;
                
                // Make page visible after successful authentication
                document.body.style.visibility = 'visible';
                
                // Update user info in sidebar
                updateUserInfo(currentUser);
                
                // Update logout links
                updateLogoutLinks();
                
                // Load dashboard data with comprehensive error handling
                await loadDashboardData();
                
                // Start real-time updates (with error handling)
                try {
                    startRealTimeUpdates();
                } catch (updateError) {
                    console.warn('⚠️ Real-time updates failed to start:', updateError);
                    // Don't fail the entire dashboard for this
                }
                
                console.log('✅ Bvester Business Dashboard initialized successfully');
                
            } catch (error) {
                console.error('❌ Critical error initializing dashboard:', error);
                
                // Show comprehensive error state with recovery options
                showErrorStateWithRecovery(error.message);
                
                // Don't automatically redirect - give user options
                console.log('🛠️ Dashboard initialization failed, user can choose recovery option');
            }
        });
    </script>
    </div> <!-- Close main-content -->
</body>
</html>